<!doctype html>
<html lang="en">
  <head>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');
      </style>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>mirisunghyung</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main>
      <div class="start-screen">
        <div class="start-screen__spinner">
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
        </div>
        <div class="start-screen__inner hidden">
          <div class="start-screen__title">성형 후 얼굴을 두가지 옵션으로 확인하세요!</div>
          <div class="start-screen__text">사진 및 웹 캠 영상은 서버에 저장되지 않습니다. </div>
          <div class="start-screen__webcam">
            <input type="radio" name="source" id="webcam" value="webcam" />
            <label id="btn-0" for="webcam">웹 캠에서 성형해보기</label>
          </div>
          <div class="start-screen__photo">
            <input type="file" id="image" accept="image/*" />
            <label id="btn-1" for="image">사진으로 성형해보기</label>
          </div>
          <div class="start-screen__image"></div>
        </div>
      </div>

      <div class="hand-gestures-tip hidden">
        <div class="hand-gestures-tip__inner">
          <div class="hand-gestures-tip__title">Tip</div>
          <div class="hand-gestures-tip__subtitle">Supported gestures:</div>
          <div class="hand-gestures-tip__content">
            <div class="hand-gestures-tip__content-item">
              <img src="assets/icons/hand_gestures/Like.svg" alt="Like" /><label
                >"Like"</label
              >
            </div>
            <div class="hand-gestures-tip__content-item">
              <img src="assets/icons/hand_gestures/Ok.svg" alt="Ok" /><label
                >"Ok"</label
              >
            </div>
            <div class="hand-gestures-tip__content-item">
              <img src="assets/icons/hand_gestures/Rock.svg" alt="Rock" /><label
                >"Rock"</label
              >
            </div>
            <div class="hand-gestures-tip__content-item">
              <img src="assets/icons/hand_gestures/Victory.svg" alt="Victory" />
              <label>"Victory"</label>
            </div>
            <div class="hand-gestures-tip__content-item">
              <img src="assets/icons/hand_gestures/Palm.svg" alt="Palm" /><label
                >"Palm"</label
              >
            </div>
          </div>
        </div>
        <button class="hand-gestures-tip__button">Close</button>
      </div>
      <div class="hand-gestures hidden"></div>
      <div class="heart-rate hidden"></div>
      <div class="test-ruler hidden"></div>
      <div id="popups" class="popups"></div>
      <div class="overlay"></div>
      <div id="webar">
      <!-- <div id="fps">
        Webcam FPS: <span id="cam"></span><br />
        Processing FPS: <span id="processing"></span><br />
        Render FPS: <span id="render"></span>
      </div> -->
      <input
        type="image"
        id="reset-button"
        src="assets/icons/controls/icon-reset.png"
        alt="reset button"
        disabled
      />
      <div class="effects">
        <div class="effect-control"></div>
        <div class="effects-list"></div>
      </div>
    </div>
      <div class="controls">
        <div id="rec-duration" class="hidden"></div>
        
        <!-- <input
          type="image"
          id="rec-button"
          src="assets/icons/controls/icon-record.svg"
          alt="rec-button"
        /> -->
        <!-- <input
          type="image"
          id="screenshot-button"
          src="assets/icons/controls/icon-screenshot.svg"
          alt="screenshot-button"
        /> -->
        <!-- <input
          type="image"
          id="mute-button"
          src="assets/icons/controls/icon-sound.svg"
          alt="mute-button"
        /> -->
      </div>
      <div class="import-message hidden">
        <div class="import-message__inner">
          To import additional filters, move the *.zip file into the
          <span>import</span> folder and add files names to
          ./import/effectsList.js file
        </div>
      </div>
      <div class="footer">
        <div class="categories-button__left hidden">
          <div class="categories-button__left-icon">
            <img src="assets/icons/controls/icon-arrow.svg" alt="left" />
          </div>
        </div>
        <div class="categories-button__right hidden">
          <div class="categories-button__right-icon">
            <img src="assets/icons/controls/icon-arrow.svg" alt="right" />
          </div>
        </div>
        <div class="categories"></div>
        <div class="technologies"></div>
      </div>
    </main>
  </body>
  <script src="BanubaClientToken.js"></script>
  <script type="module" src="main.js"></script>
  <!-- 수업중 axios를 사용하기 위해 CDN 추가 -->
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

  <script>
    const appscript = 'https://script.google.com/macros/s/AKfycbzOKYXHe0XVITe3D8jymUrs_dIEDYRf_UYmcUxatUGmjbLalfMhPNqHvCMd-hFt_aazaQ/exec'
    function getCookieValue(name) {
      const value = "; " + document.cookie;
      const parts = value.split("; " + name + "=");
      if (parts.length === 2) {
          return parts.pop().split(";").shift();
      }
    
    }
        // 쿠키에 값을 저장하는 함수
    function setCookieValue(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }
    function getUVfromCookie() {
    // 6자리 임의의 문자열 생성
      const hash = Math.random().toString(36).substring(2, 8).toUpperCase();
      // 쿠키에서 기존 해시 값을 가져옴
      const existingHash = getCookieValue("user");
      // 기존 해시 값이 없으면, 새로운 해시 값을 쿠키에 저장
      if (!existingHash) {
          setCookieValue("user", hash, 180); // 쿠키 만료일은 6개월 
          return hash;
      } else {
          // 기존 해시 값이 있으면, 기존 값을 반환
          return existingHash;
      }
    }
    // Sam pading value to start with 0. eg: 01, 02, .. 09, 10, ..
    function padValue(value) {
        return (value < 10) ? "0" + value : value;
    }

    function getTimeStamp() {
    const date = new Date();

      const year = date.getFullYear();
      const month = date.getMonth() + 1;
      const day = date.getDate();
      const hours = date.getHours();
      const minutes = date.getMinutes();
      const seconds = date.getSeconds();

      const formattedDate = `${padValue(year)}-${padValue(month)}-${padValue(day)} ${padValue(hours)}:${padValue(minutes)}:${padValue(seconds)}`;

    return formattedDate;
}
    function handleClick(event, i){
      // var sendData = JSON.stringify(
      //   {
      //     "id": getUVfromCookie(),
      //     "time_stamp": getTimeStamp(),
      //     "btn": `${i}`
      //   }
      // ) 
      // var appscript_link ='https://script.google.com/macros/s/AKfycbzOKYXHe0XVITe3D8jymUrs_dIEDYRf_UYmcUxatUGmjbLalfMhPNqHvCMd-hFt_aazaQ/exec'
      
      // axios.get(appscript_link+'?action=insert&table=tab_cam_pic&data='+sendData)
      //                 .then(response => {
      //                 console.log(JSON.stringify(response));
                      
      //             })
      //             .catch(error => {
      //         console.error("Error:", error);
      //         alert("오류가 발생했습니다. 관리자에게 문의하세요.");
      //     });;
    }

    document.getElementById('btn-0').addEventListener('click', function(event){
            handleClick(event, 0);
        });
    
    document.getElementById('btn-1').addEventListener('click', function(event){
            handleClick(event, 1);
        });

  </script>
  
</html>
